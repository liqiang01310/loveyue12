<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>浪漫爱心互动</title>
<style>
body{
    margin:0;
    overflow:hidden;
    background:black;
}
canvas{
    display:block;
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>

<!-- 背景音乐 -->
<audio id="bgm" loop>
  <source src="https://www.bensound.com/bensound-music/bensound-romantic.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let time = 0;

// 星空粒子
const stars = [];
for(let i=0;i<200;i++){
    stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*1.5+0.5, alpha: Math.random()});
}

// 花瓣
const petals = [];
const petalColors = ['#ffb6c1','#ff69b4','#ffc0cb','#ff1493'];
for(let i=0;i<50;i++){
    petals.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, size: Math.random()*8+4, speed: Math.random()*1+0.5, color: petalColors[Math.floor(Math.random()*petalColors.length)], angle: Math.random()*Math.PI*2});
}

// 点击炸开的花瓣
const burstPetals = [];

// 爱心函数
function heart(t, scale){
    const x = 16 * Math.pow(Math.sin(t),3);
    const y = 13*Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
    return {x: x*scale, y: -y*scale};
}

// 绘制
function draw(scale){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // 星空背景
    stars.forEach(s=>{
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, 2*Math.PI);
        ctx.fillStyle = `rgba(255,255,255,${s.alpha})`;
        ctx.fill();
        s.alpha += (Math.random()-0.5)*0.02;
        if(s.alpha>1) s.alpha=1;
        if(s.alpha<0) s.alpha=0;
    });

    // 普通花瓣
    petals.forEach(p=>{
        p.y += p.speed;
        p.x += Math.sin(time+p.angle)*0.5;
        if(p.y>canvas.height) p.y = -p.size;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.fill();
    });

    // 炸开花瓣
    for(let i=burstPetals.length-1;i>=0;i--){
        let p = burstPetals[i];
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.05; // 重力
        p.angle += 0.1;
        ctx.save();
        ctx.translate(p.x,p.y);
        ctx.rotate(p.angle);
        ctx.beginPath();
        ctx.arc(0,0,p.size,0,Math.PI*2);
        ctx.fillStyle = p.color;
        ctx.fill();
        ctx.restore();
        if(p.y>canvas.height+50) burstPetals.splice(i,1);
    }

    // 爱心渐变发光
    let gradient = ctx.createRadialGradient(canvas.width/2, canvas.height/2, 10, canvas.width/2, canvas.height/2, 200);
    gradient.addColorStop(0,'#ff5c5c');
    gradient.addColorStop(0.5,'#ff2a8f');
    gradient.addColorStop(1,'#ff0000');

    ctx.fillStyle = gradient;
    ctx.shadowColor = '#ff69b4';
    ctx.shadowBlur = 20;

    ctx.beginPath();
    for(let t=0;t<Math.PI*2;t+=0.01){
        const p = heart(t, scale);
        if(t===0) ctx.moveTo(canvas.width/2 + p.x, canvas.height/2 + p.y);
        else ctx.lineTo(canvas.width/2 + p.x, canvas.height/2 + p.y);
    }
    ctx.closePath();
    ctx.fill();

    // 文字
    ctx.shadowBlur = 0;
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 48px sans-serif';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('我爱你', canvas.width/2, canvas.height/2);
}

// 动画
function animate(){
    time += 0.05;
    const scale = 15 + 2*Math.sin(time*2); // 跳动
    draw(scale);
    requestAnimationFrame(animate);
}

animate();

// 点击屏幕炸开花瓣
canvas.addEventListener('click', function(e){
    const x0 = canvas.width/2;
    const y0 = canvas.height/2;
    for(let i=0;i<30;i++){
        burstPetals.push({
            x: x0,
            y: y0,
            size: Math.random()*6+4,
            color: petalColors[Math.floor(Math.random()*petalColors.length)],
            angle: Math.random()*Math.PI*2,
            vx: (Math.random()-0.5)*6,
            vy: (Math.random()-0.5)*-6
        });
    }

    // 播放背景音乐（微信需用户操作）
    const bgm = document.getElementById('bgm');
    if(bgm.paused) bgm.play();
});
</script>
</body>

</html>
